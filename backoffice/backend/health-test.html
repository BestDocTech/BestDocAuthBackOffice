<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Health Check Test</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
      background-color: #f5f5f5;
    }

    .container {
      background: white;
      padding: 30px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    .status {
      padding: 10px;
      border-radius: 4px;
      margin: 10px 0;
    }

    .healthy {
      background-color: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }

    .error {
      background-color: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }

    .loading {
      background-color: #fff3cd;
      color: #856404;
      border: 1px solid #ffeaa7;
    }

    button {
      background-color: #007bff;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 4px;
      cursor: pointer;
      margin: 10px 5px;
    }

    button:hover {
      background-color: #0056b3;
    }

    pre {
      background-color: #f8f9fa;
      padding: 15px;
      border-radius: 4px;
      overflow-x: auto;
      white-space: pre-wrap;
    }

    .endpoint {
      font-family: monospace;
      background-color: #e9ecef;
      padding: 5px;
      border-radius: 3px;
    }
  </style>
</head>

<body>
  <div class="container">
    <h1>üè• Health Check Test</h1>
    <p>Test the Netlify functions health endpoint to verify the backend is working.</p>

    <div>
      <h3>Test Endpoints:</h3>
      <p><span class="endpoint">GET /.netlify/functions/health</span> - Basic health check</p>
      <p><span class="endpoint">POST /.netlify/functions/health</span> - Health check with POST</p>
    </div>

    <div>
      <button onclick="testHealth('GET')">Test GET Health</button>
      <button onclick="testHealth('POST')">Test POST Health</button>
      <button onclick="clearResults()">Clear Results</button>
    </div>

    <div id="results"></div>
  </div>

  <script>
    async function testHealth(method) {
      const resultsDiv = document.getElementById('results');
      const resultId = `result-${Date.now()}`;

      // Add loading status
      const loadingDiv = document.createElement('div');
      loadingDiv.id = resultId;
      loadingDiv.className = 'status loading';
      loadingDiv.innerHTML = `üîÑ Testing ${method} health endpoint...`;
      resultsDiv.appendChild(loadingDiv);

      try {
        const response = await fetch('/.netlify/functions/health', {
          method: method,
          headers: {
            'Content-Type': 'application/json'
          }
        });

        const data = await response.json();

        // Update with result
        loadingDiv.className = response.ok ? 'status healthy' : 'status error';
        loadingDiv.innerHTML = `
                    <strong>${response.ok ? '‚úÖ' : '‚ùå'} ${method} Health Check</strong><br>
                    <strong>Status:</strong> ${response.status} ${response.statusText}<br>
                    <strong>Timestamp:</strong> ${new Date().toLocaleString()}<br>
                    <strong>Response:</strong>
                    <pre>${JSON.stringify(data, null, 2)}</pre>
                `;

      } catch (error) {
        loadingDiv.className = 'status error';
        loadingDiv.innerHTML = `
                    <strong>‚ùå ${method} Health Check Failed</strong><br>
                    <strong>Error:</strong> ${error.message}<br>
                    <strong>Timestamp:</strong> ${new Date().toLocaleString()}
                `;
      }
    }

    function clearResults() {
      document.getElementById('results').innerHTML = '';
    }

    // Auto-test on page load
    window.addEventListener('load', () => {
      setTimeout(() => testHealth('GET'), 1000);
    });
  </script>
</body>

</html>